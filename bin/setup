#!/usr/bin/env bash

clean=false
start_=false

while getopts "d:cs" opt; do
	case $opt in
		d)
			hotfolder=$OPTARG
			;;
		c)
			clean=true
			;;
		s)
			start_=true
			;;
	esac
done

md_ln=resources/posts
html_dir=resources/posts-html

if [ -e "$md_ln" ]; then
	rm $md_ln
fi

if [ ! -d "$html_dir" ]; then
	mkdir $html_dir
elif $clean; then
	rm -r $html_dir
	mkdir $html_dir
fi

ln -s "$hotfolder" "$md_ln"

if $start_; then
	echo "Starting server..."
	lein run
fi